import{d as U,r as I,ao as C,a as S,E as T,C as p,b as A,w as o,e,f as q,o as f,g as a,I as P,h as R,z as y,A as D,i as N,j as r,x as v,G as j,ae as G,k as L,n as k,m as M,l as O,q as z,s as u,t as g,K as w,L as s,an as _,v as F,M as H,y as K}from"./index-yNZZBFxb.js";const W={class:"ion-padding"},J={key:1,class:"ion-text-center ion-padding"},Y=U({__name:"EditRecipePage",setup(Q){const x=C(),c=q(),d=I(!1),b=I(!1),m=x.params.id,t=S({titulo:"",categoria:"principal",dificultad:"media",tiempo:30,imagen:"",ingredientes:"",pasos:""});T(async()=>{try{const n=await p.collection("recipes").getOne(m);t.titulo=n.title,t.categoria=n.category,t.dificultad=n.difficulty,t.tiempo=n.time,t.imagen=n.image||"",t.ingredientes=Array.isArray(n.ingredients)?n.ingredients.join("\n"):n.ingredients,t.pasos=Array.isArray(n.steps)?n.steps.join("\n"):n.steps,b.value=!0}catch(n){console.error(n)}});function V(n){return n.split("\n").map(l=>l.trim()).filter(l=>l.length>0)}async function B(){d.value=!0;try{const n={title:t.titulo.trim(),category:t.categoria,difficulty:t.dificultad,time:Number(t.tiempo),image:t.imagen.trim()||null,ingredients:V(t.ingredientes),steps:V(t.pasos)};await p.collection("recipes").update(m,n),c.replace("/tabs/home")}catch(n){console.error(n),alert("Error al guardar cambios")}finally{d.value=!1}}async function E(){if(confirm("¿Seguro que quieres eliminar esta receta?"))try{await p.collection("recipes").delete(m),c.replace("/tabs/home")}catch(n){console.error(n),alert("Error al eliminar")}}return(n,l)=>(f(),A(e(K),null,{default:o(()=>[a(e(P),null,{default:o(()=>[a(e(R),null,{default:o(()=>[a(e(y),{slot:"start"},{default:o(()=>[a(e(D),{"default-href":"/home"})]),_:1}),a(e(N),null,{default:o(()=>[...l[7]||(l[7]=[r("Editar Receta",-1)])]),_:1}),a(e(y),{slot:"end"},{default:o(()=>[a(e(v),{color:"danger",onClick:E},{default:o(()=>[a(e(j),{icon:e(G)},null,8,["icon"])]),_:1})]),_:1})]),_:1})]),_:1}),a(e(L),{class:"ion-padding"},{default:o(()=>[b.value?(f(),k("form",{key:0,onSubmit:M(B,["prevent"])},[a(e(z),null,{default:o(()=>[a(e(u),null,{default:o(()=>[a(e(g),{label:"Título","label-placement":"floating",modelValue:t.titulo,"onUpdate:modelValue":l[0]||(l[0]=i=>t.titulo=i),required:""},null,8,["modelValue"])]),_:1}),a(e(u),null,{default:o(()=>[a(e(w),{label:"Categoría",modelValue:t.categoria,"onUpdate:modelValue":l[1]||(l[1]=i=>t.categoria=i)},{default:o(()=>[a(e(s),{value:"entrante"},{default:o(()=>[...l[8]||(l[8]=[r("Entrante",-1)])]),_:1}),a(e(s),{value:"principal"},{default:o(()=>[...l[9]||(l[9]=[r("Principal",-1)])]),_:1}),a(e(s),{value:"postre"},{default:o(()=>[...l[10]||(l[10]=[r("Postre",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(e(u),null,{default:o(()=>[a(e(w),{label:"Dificultad",modelValue:t.dificultad,"onUpdate:modelValue":l[2]||(l[2]=i=>t.dificultad=i)},{default:o(()=>[a(e(s),{value:"facil"},{default:o(()=>[...l[11]||(l[11]=[r("Fácil",-1)])]),_:1}),a(e(s),{value:"media"},{default:o(()=>[...l[12]||(l[12]=[r("Media",-1)])]),_:1}),a(e(s),{value:"dificil"},{default:o(()=>[...l[13]||(l[13]=[r("Difícil",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(e(u),null,{default:o(()=>[a(e(g),{label:"Tiempo (min)",type:"number","label-placement":"floating",modelValue:t.tiempo,"onUpdate:modelValue":l[3]||(l[3]=i=>t.tiempo=i),required:""},null,8,["modelValue"])]),_:1}),a(e(u),null,{default:o(()=>[a(e(g),{label:"URL Imagen","label-placement":"floating",modelValue:t.imagen,"onUpdate:modelValue":l[4]||(l[4]=i=>t.imagen=i)},null,8,["modelValue"])]),_:1}),a(e(u),null,{default:o(()=>[a(e(_),{label:"Ingredientes (uno por línea)","label-placement":"floating",modelValue:t.ingredientes,"onUpdate:modelValue":l[5]||(l[5]=i=>t.ingredientes=i),rows:5},null,8,["modelValue"])]),_:1}),a(e(u),null,{default:o(()=>[a(e(_),{label:"Pasos (uno por línea)","label-placement":"floating",modelValue:t.pasos,"onUpdate:modelValue":l[6]||(l[6]=i=>t.pasos=i),rows:5},null,8,["modelValue"])]),_:1})]),_:1}),O("div",W,[a(e(v),{expand:"block",type:"submit",disabled:d.value},{default:o(()=>[r(F(d.value?"Guardando...":"Guardar Cambios"),1)]),_:1},8,["disabled"])])],32)):(f(),k("div",J,[a(e(H))]))]),_:1})]),_:1}))}});export{Y as default};
