System.register(["./index-legacy-BLxyB22v.js","./_plugin-vue_export-helper-legacy-BVIICed7.js"],function(e,a){"use strict";var l,t,i,n,o,r,u,c,d,s,f,v,p,m,g,h,_,y,b,x,k,C,w,z,V,E,S,R,U,P,$,j,M,N,q,A,G,B,I,Q,W,F,L,H,O,X,Y,D,J,K;return{setters:[e=>{l=e.d,t=e.u,i=e.r,n=e.c,o=e.E,r=e.C,u=e.b,c=e.w,d=e.e,s=e.f,f=e.o,v=e.g,p=e.I,m=e.h,g=e.i,h=e.j,_=e.z,y=e.x,b=e.G,x=e.H,k=e.a7,C=e.a8,w=e.a3,z=e.k,V=e.n,E=e.p,S=e.l,R=e.F,U=e.m,P=e.q,$=e.s,j=e.t,M=e.v,N=e.a9,q=e.N,A=e.O,G=e.P,B=e.Q,I=e.R,Q=e.S,W=e.W,F=e.Y,L=e.X,H=e.aa,O=e.ab,X=e.ac,Y=e.ad,D=e.ae,J=e.y},e=>{K=e._}],execute:function(){var a=document.createElement("style");a.textContent=".profile-header[data-v-0854054c]{text-align:center;padding:20px}.recipe-card[data-v-0854054c]{height:100%;display:flex;flex-direction:column;margin:0;border-radius:12px;overflow:hidden;box-shadow:0 4px 12px rgba(0,0,0,.3)}.image-container[data-v-0854054c]{width:100%;height:150px;overflow:hidden;position:relative}.image-container img[data-v-0854054c]{width:100%;height:100%;object-fit:cover;transition:transform .4s ease}.recipe-card:hover .image-container img[data-v-0854054c]{transform:scale(1.05)}.recipe-meta[data-v-0854054c]{display:flex;justify-content:space-between;align-items:center;margin-top:8px}.meta-info[data-v-0854054c]{display:flex;align-items:center;gap:4px}.pagination[data-v-0854054c]{display:flex;justify-content:center;align-items:center;gap:16px;margin-top:20px}\n/*$vite$:1*/",document.head.appendChild(a);const T={key:0},Z={class:"ion-text-center ion-padding"},ee=["src"],ae={class:"ion-padding"},le={key:1},te={class:"ion-padding"},ie={key:0,class:"ion-text-center"},ne={class:"image-container"},oe=["src"],re={class:"recipe-meta"},ue={class:"meta-info"},ce={key:2,class:"pagination"},de={key:2},se={key:0,class:"ion-text-center"},fe={class:"image-container"},ve=["src"],pe={class:"recipe-meta"},me={class:"meta-info"},ge={key:2,class:"pagination"};e("default",K(l({__name:"ProfilePage",setup(e){const a=s(),l=t(),K=i("info"),he=i(""),_e=i(""),ye=i(""),be=i(!1),xe=i([]),ke=i([]),Ce=i(1),we=i(1),ze=n(()=>{const e=8*(Ce.value-1);return xe.value.slice(e,e+8)}),Ve=n(()=>{const e=8*(we.value-1);return ke.value.slice(e,e+8)}),Ee=n(()=>Math.ceil(xe.value.length/8)),Se=n(()=>Math.ceil(ke.value.length/8));async function Re(){var e;const a=null===(e=r.authStore.model)||void 0===e?void 0:e.id;if(a)try{const e=await r.collection("recipes").getFullList({filter:`author = "${a}"`,sort:"-created"});xe.value=e,ke.value=l.savedRecipes||[]}catch(t){console.error(t)}}function Ue(e){Ce.value=e}function Pe(e){we.value=e}function $e(){l.logout(),a.replace("/login")}function je(e){return"entrante"===e?"success":"principal"===e?"primary":"postre"===e?"warning":"medium"}function Me(e){return"facil"===e?"green":"media"===e?"orange":"dificil"===e?"red":"gray"}function Ne(e){if(e.image){if("string"==typeof e.image&&(e.image.startsWith("http://")||e.image.startsWith("https://")))return e.image;if(r.baseUrl)try{return r.files.getUrl(e,e.image,{thumb:"300x300"})}catch{return"https://via.placeholder.com/300x200?text=Receta"}}return"https://via.placeholder.com/300x200?text=Receta"}function qe(e){e.target.src="https://via.placeholder.com/300x200?text=Receta"}async function Ae(){be.value=!0;try{var e;const a=null===(e=r.authStore.model)||void 0===e?void 0:e.id;if(!a)return;const t={name:he.value,avatar:ye.value};await r.collection("users").update(a,t),l.user={...l.user,...t},alert("Perfil actualizado")}catch(a){console.error(a),alert("Error al actualizar")}finally{be.value=!1}}async function Ge(){if(confirm("¿Seguro que quieres borrar tu perfil? Esta acción no se puede deshacer."))try{var e;const t=null===(e=r.authStore.model)||void 0===e?void 0:e.id;if(!t)return;await r.collection("users").delete(t),l.logout(),a.replace("/login")}catch(t){console.error(t),alert("Error al eliminar cuenta")}}return o(async()=>{var e,a,t;he.value=(null===(e=l.user)||void 0===e?void 0:e.name)||"",_e.value=(null===(a=l.user)||void 0===a?void 0:a.email)||"",ye.value=(null===(t=l.user)||void 0===t?void 0:t.avatar)||"",await Re()}),(e,t)=>(f(),u(d(J),null,{default:c(()=>[v(d(p),null,{default:c(()=>[v(d(m),null,{default:c(()=>[v(d(g),null,{default:c(()=>[...t[8]||(t[8]=[h("Mi Perfil",-1)])]),_:1}),v(d(_),{slot:"end"},{default:c(()=>[v(d(y),{onClick:$e},{default:c(()=>[v(d(b),{icon:d(x)},null,8,["icon"])]),_:1})]),_:1})]),_:1}),v(d(m),null,{default:c(()=>[v(d(k),{modelValue:K.value,"onUpdate:modelValue":t[0]||(t[0]=e=>K.value=e)},{default:c(()=>[v(d(C),{value:"info"},{default:c(()=>[v(d(w),null,{default:c(()=>[...t[9]||(t[9]=[h("Perfil",-1)])]),_:1})]),_:1}),v(d(C),{value:"mis-recetas"},{default:c(()=>[v(d(w),null,{default:c(()=>[...t[10]||(t[10]=[h("Mis Recetas",-1)])]),_:1})]),_:1}),v(d(C),{value:"guardadas"},{default:c(()=>[v(d(w),null,{default:c(()=>[...t[11]||(t[11]=[h("Guardadas",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),v(d(z),{class:"ion-padding"},{default:c(()=>["info"===K.value?(f(),V("div",T,[S("div",Z,[v(d(R),{style:{width:"120px",height:"120px",margin:"0 auto"}},{default:c(()=>[S("img",{src:ye.value?ye.value:"https://ui-avatars.com/api/?name="+encodeURIComponent(he.value||_e.value||"Usuario")+"&background=random",alt:"Avatar"},null,8,ee)]),_:1})]),S("form",{onSubmit:U(Ae,["prevent"])},[v(d(P),null,{default:c(()=>[v(d($),null,{default:c(()=>[v(d(j),{label:"Nombre","label-placement":"floating",modelValue:he.value,"onUpdate:modelValue":t[1]||(t[1]=e=>he.value=e)},null,8,["modelValue"])]),_:1}),v(d($),null,{default:c(()=>[v(d(j),{label:"Email","label-placement":"floating",modelValue:_e.value,"onUpdate:modelValue":t[2]||(t[2]=e=>_e.value=e),readonly:""},null,8,["modelValue"])]),_:1}),v(d($),null,{default:c(()=>[v(d(j),{label:"Avatar URL","label-placement":"floating",modelValue:ye.value,"onUpdate:modelValue":t[3]||(t[3]=e=>ye.value=e)},null,8,["modelValue"])]),_:1})]),_:1}),S("div",ae,[v(d(y),{expand:"block",type:"submit",disabled:be.value},{default:c(()=>[h(M(be.value?"Guardando...":"Guardar Cambios"),1)]),_:1},8,["disabled"]),v(d(y),{expand:"block",fill:"outline",color:"danger",onClick:Ge},{default:c(()=>[...t[12]||(t[12]=[h(" Borrar Mi Cuenta ",-1)])]),_:1})])],32)])):E("",!0),"mis-recetas"===K.value?(f(),V("div",le,[S("div",te,[v(d(y),{expand:"block","router-link":"/recipes/new",color:"primary"},{default:c(()=>[v(d(b),{icon:d(N),slot:"start"},null,8,["icon"]),t[13]||(t[13]=h(" Crear Nueva Receta ",-1))]),_:1})]),0===ze.value.length?(f(),V("p",ie,"No tienes recetas.")):(f(),u(d(q),{key:1},{default:c(()=>[v(d(A),null,{default:c(()=>[(f(!0),V(G,null,B(ze.value,e=>(f(),u(d(I),{size:"6","size-md":"4","size-lg":"3",key:e.id},{default:c(()=>[v(d(Q),{button:"",onClick:l=>d(a).push(`/recipes/${e.id}`),class:"recipe-card"},{default:c(()=>[S("div",ne,[S("img",{src:Ne(e),onError:qe},null,40,oe)]),v(d(W),null,{default:c(()=>[v(d(F),null,{default:c(()=>[h(M(e.title),1)]),_:2},1024),S("div",re,[v(d(L),{color:je(e.category)},{default:c(()=>[h(M(e.category),1)]),_:2},1032,["color"]),S("div",ue,[v(d(b),{icon:d(O),style:H({color:Me(e.difficulty)})},null,8,["icon","style"]),S("span",null,M(e.time)+"min",1)])])]),_:2},1024),v(d(X),null,{default:c(()=>[v(d(y),{size:"small",fill:"outline",onClick:U(l=>function(e){a.push(`/recipes/${e.id}/edit`)}(e),["stop"])},{default:c(()=>[v(d(b),{icon:d(Y),slot:"start"},null,8,["icon"]),t[14]||(t[14]=h(" Editar ",-1))]),_:1},8,["onClick"]),v(d(y),{size:"small",fill:"clear",color:"danger",onClick:U(a=>async function(e){if(confirm("¿Borrar receta?"))try{await r.collection("recipes").delete(e.id),await Re()}catch(a){console.error(a)}}(e),["stop"])},{default:c(()=>[v(d(b),{icon:d(D),slot:"start"},null,8,["icon"]),t[15]||(t[15]=h(" Borrar ",-1))]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})]),_:1})),Ee.value>1?(f(),V("div",ce,[v(d(y),{disabled:1===Ce.value,onClick:t[4]||(t[4]=e=>Ue(Ce.value-1))},{default:c(()=>[...t[16]||(t[16]=[h("Anterior",-1)])]),_:1},8,["disabled"]),S("span",null,"Página "+M(Ce.value)+" de "+M(Ee.value),1),v(d(y),{disabled:Ce.value===Ee.value,onClick:t[5]||(t[5]=e=>Ue(Ce.value+1))},{default:c(()=>[...t[17]||(t[17]=[h("Siguiente",-1)])]),_:1},8,["disabled"])])):E("",!0)])):E("",!0),"guardadas"===K.value?(f(),V("div",de,[0===Ve.value.length?(f(),V("p",se,"No tienes recetas guardadas.")):(f(),u(d(q),{key:1},{default:c(()=>[v(d(A),null,{default:c(()=>[(f(!0),V(G,null,B(Ve.value,e=>(f(),u(d(I),{size:"6","size-md":"4","size-lg":"3",key:e.id},{default:c(()=>[v(d(Q),{button:"",onClick:l=>d(a).push(`/recipes/${e.id}`),class:"recipe-card"},{default:c(()=>[S("div",fe,[S("img",{src:Ne(e),onError:qe},null,40,ve)]),v(d(W),null,{default:c(()=>[v(d(F),null,{default:c(()=>[h(M(e.title),1)]),_:2},1024),S("div",pe,[v(d(L),{color:je(e.category)},{default:c(()=>[h(M(e.category),1)]),_:2},1032,["color"]),S("div",me,[v(d(b),{icon:d(O),style:H({color:Me(e.difficulty)})},null,8,["icon","style"]),S("span",null,M(e.time)+"min",1)])])]),_:2},1024),v(d(X),null,{default:c(()=>[v(d(y),{size:"small",fill:"outline",onClick:U(l=>d(a).push(`/recipes/${e.id}`),["stop"])},{default:c(()=>[v(d(b),{icon:d(Y),slot:"start"},null,8,["icon"]),t[18]||(t[18]=h(" Ver ",-1))]),_:1},8,["onClick"]),v(d(y),{size:"small",fill:"clear",color:"danger",onClick:U(a=>async function(e){if(confirm("¿Quitar de guardadas?"))try{await l.toggleSaved(e.id),await Re()}catch(a){console.error(a),alert(a.message||"Error al quitar de guardadas")}}(e),["stop"])},{default:c(()=>[v(d(b),{icon:d(D),slot:"start"},null,8,["icon"]),t[19]||(t[19]=h(" Quitar de guardadas ",-1))]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})]),_:1})),Se.value>1?(f(),V("div",ge,[v(d(y),{disabled:1===we.value,onClick:t[6]||(t[6]=e=>Pe(we.value-1))},{default:c(()=>[...t[20]||(t[20]=[h("Anterior",-1)])]),_:1},8,["disabled"]),S("span",null,"Página "+M(we.value)+" de "+M(Se.value),1),v(d(y),{disabled:we.value===Se.value,onClick:t[7]||(t[7]=e=>Pe(we.value+1))},{default:c(()=>[...t[21]||(t[21]=[h("Siguiente",-1)])]),_:1},8,["disabled"])])):E("",!0)])):E("",!0)]),_:1})]),_:1}))}}),[["__scopeId","data-v-0854054c"]]))}}});
